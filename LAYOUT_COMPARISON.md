# レイアウト比較: index.html vs viewer.html

## index.html（検索ページ）

```
┌─────────────────────────────────────────────────────────────────┐
│ 検索コントロールパネル                                           │
│ • Target入力                                                     │
│ • P.A.設定                                                       │
│ • カタログ読み込み                                               │
│ • サーベイ選択                                                   │
│ • 等級フィルター                                                 │
│ • [詳細ビューで表示] ボタン ← 新規追加                          │
├──────────────────────────────┬──────────────────────────────────┤
│                              │                                  │
│                              │  Stars in FoV (25 arcmin)        │
│                              │  ┌─────────────────────────────┐ │
│                              │  │ 凡例                        │ │
│  Aladin Lite画像             │  │ ○ 推奨ガイド星              │ │
│  （大きめ・可変幅）          │  └─────────────────────────────┘ │
│                              │                                  │
│                              │  星リスト                        │
│                              │  • #1 星の情報                   │
│                              │  • #2 星の情報                   │
│                              │  • ...                           │
│                              │                                  │
│                              │  （幅: 400px固定）               │
│                              │                                  │
│                              ├──────────────────────────────────┤
│                              │  観測座標                        │
│                              │  観測可能性チェック              │
└──────────────────────────────┴──────────────────────────────────┘
```

**特徴:**
- 検索機能を優先
- Aladin画像が大きく、視野の確認がしやすい
- 右パネルは固定幅400px
- すべてのコントロールが利用可能

---

## viewer.html（詳細表示ページ）

```
┌─────────────────────────────────────────────────────────────────┐
│ ヘッダー                                                         │
│ Sky Viewer - 検索結果        Target: 18h09m...  [← 新規検索]    │
├──────────────────────────────┬──────────────────────────────────┤
│                              │                                  │
│  Aladin Lite画像             │  視野内の星 (25 arcmin)          │
│  （小さめ・400px固定）       │                                  │
│                              │  ┌─────────────────────────────┐ │
│                              │  │ 等級フィルター              │ │
│                              │  │ [適用]                      │ │
│  ┌─────────────────────────┐ │  └─────────────────────────────┘ │
│  │ 視野: 25 arcmin         │ │                                  │
│  │ P.A.: 0° ±30°           │ │  星リスト（詳細情報付き）        │
│  │                         │ │  ┌─────────────────────────────┐ │
│  │ マーカー凡例            │ │  │ #1 RA: ... Dec: ...         │ │
│  │ ● 選択された星          │ │  │    分離: 5.23'  P.A.: 45°   │ │
│  │ ○ 推奨ガイド星          │ │  │    カタログ: BrightKg...    │ │
│  │ ○ その他の星            │ │  │    W1mag: 6.26              │ │
│  └─────────────────────────┘ │  │    teff_gspphot: 4462.3     │ │
│                              │  │    ...（その他の詳細）       │ │
│                              │  └─────────────────────────────┘ │
│                              │  ┌─────────────────────────────┐ │
│                              │  │ #2 RA: ... Dec: ...         │ │
│                              │  │    ...                      │ │
│                              │  └─────────────────────────────┘ │
│                              │                                  │
│                              │  （幅: 可変・広め）              │
│                              │                                  │
├──────────────────────────────┼──────────────────────────────────┤
│                              │  観測座標                        │
│                              │  [この星で観測する]              │
│                              │  [MIMIZUKU表示]                  │
└──────────────────────────────┴──────────────────────────────────┘
```

**特徴:**
- 詳細表示を優先
- Aladin画像は小さく（400px固定）、参照用
- 星リストが広く、詳細情報を表示可能
- 検索コントロールは非表示
- ヘッダーに「新規検索」ボタンで簡単に戻れる

---

## 主な違い

| 項目 | index.html | viewer.html |
|------|------------|-------------|
| **Aladinサイズ** | 可変（大きめ） | 400px固定（小さめ） |
| **星リストサイズ** | 400px固定 | 可変（広め） |
| **検索コントロール** | あり | なし |
| **カタログ読み込み** | あり | なし |
| **詳細ビューボタン** | あり | なし |
| **新規検索ボタン** | なし | あり（ヘッダー） |
| **マーカー凡例** | 右パネル内 | Aladin下部 |
| **目的** | 検索・初期確認 | 詳細確認・選択 |

---

## ナビゲーションフロー

```
┌──────────────┐
│ index.html   │ ← スタート地点
│ (検索ページ) │
└──────┬───────┘
       │
       │ 1. 座標入力
       │ 2. カタログ読み込み
       │ 3. Search実行
       │
       ▼
┌──────────────┐
│ index.html   │
│ (結果表示)   │
│              │
│ [詳細ビュー  │ ← ボタンが有効化される
│  で表示 →]   │
└──────┬───────┘
       │
       │ クリック
       │ (sessionStorageに状態保存)
       │
       ▼
┌──────────────┐
│ viewer.html  │
│ (詳細表示)   │
│              │
│ [← 新規検索] │ ← 戻るボタン
└──────┬───────┘
       │
       │ クリック
       │
       ▼
┌──────────────┐
│ index.html   │ ← 初期状態に戻る
│ (検索ページ) │
└──────────────┘
```

---

## 実装のポイント

### sessionStorageの活用

ページ遷移時に以下の情報を保存：
- ターゲット座標（ra, dec）
- 入力された座標文字列
- P.A.設定（角度、許容範囲、有効/無効）
- 読み込まれたカタログデータ

これにより、viewer.htmlで同じ状態を完全に復元できます。

### レスポンシブデザイン

- `flex`レイアウトを使用
- Aladin画像は固定サイズ、星リストは可変サイズ
- 両ページで一貫したデザイン言語

### マーカー色の仕組み

```javascript
// 通常の星
color: '#00BFFF'  // DeepSkyBlue (青)
size: 12

// 推奨ガイド星
color: '#ff00ff'  // Magenta (マゼンタ)
size: 12

// 選択された星
color: '#ff0000'  // Red (赤)
size: 16  // サイズも大きくなる
```

選択状態が変わるたびに`plotStarsOnAladin()`が呼ばれ、全マーカーが再描画されます。
