# MIMIZUKU Dual Field 改善案 実装

このディレクトリには、MIMIZUKU Dual Field PNG View の2つの改善案の実装が含まれています。

## 問題の概要

離れた天体を同時に観測する際、PNG Viewで表示される画像が小さく・粗くなる問題がありました。
これは、天体間距離が大きくなると視野角（FoV）が拡大し、固定サイズ（1'×2'）の切り出しピクセル数が減少するためです。

## 実装した2つの改善案

### 📁 solution1/ - 固定サイズ表示 + 高解像度化

**アプローチ**: 現在のアーキテクチャを維持しつつ、出力画像を固定サイズにスケールアップ

**特徴**:
- 実装が簡単（約2-3時間）
- 各フィールドを300×600pxの固定サイズで出力
- html2canvasのscaleを3→5に増加
- 画質スムージングを有効化

**適用場面**:
- 即効性のある改善が必要な場合
- 既存UIを維持したい場合

**制約**:
- 元画像の解像度が低い場合、スケールアップしても画質改善には限界がある

### 📁 solution2/ - 分離表示モード

**アプローチ**: 天体間距離に応じて、各天体を中心とした独立した2つのAladinビューを使用

**特徴**:
- 距離閾値（10分角）で自動モード切り替え
- 各天体を狭いFoV（3分角）で高解像度表示
- 2つのAladinインスタンスを並列使用
- 天体間距離に関係なく一定の高画質を保証

**適用場面**:
- 根本的な高画質化が必要な場合
- 天体間距離が大きい観測が多い場合

**制約**:
- 実装がより複雑（約1-2日）
- メモリ使用量が増加
- 分離モード時は相対位置関係がわかりにくい

## 使い方

### Solution 1を試す
```bash
# ブラウザで開く
open solution1/index.html
```

### Solution 2を試す
```bash
# ブラウザで開く
open solution2/index.html
```

## ファイル構成

```
solution1/
├── README.md       # Solution 1の詳細説明
├── index.html      # エントリーポイント
├── app.js          # 固定サイズスケーリング実装
└── viewer.html     # ビューワーページ

solution2/
├── README.md       # Solution 2の詳細説明
├── index.html      # エントリーポイント
├── app.js          # 分離表示モード実装
└── viewer.html     # ビューワーページ
```

## 推奨実装戦略

調査報告書（`MIMIZUKU_DUAL_FIELD_改善調査報告.md`）では、以下の段階的実装を推奨しています：

1. **フェーズ1**: Solution 1を実装してリリース
   - 即効性のある改善を提供
   - ユーザーフィードバックを収集

2. **フェーズ2**: Solution 2を実装してリリース
   - Solution 1のフィードバックを元に調整
   - 根本的な解決を提供

## 技術的な詳細

両方の実装について、詳細な技術情報は各フォルダ内の `README.md` を参照してください。

## テスト方法

1. CSVカタログファイルを読み込む
2. ターゲット天体を検索
3. ガイド星を選択（近い星と遠い星で試す）
4. "Show MIMIZUKU Dual Field" をクリック
5. "Switch to PNG View" をクリック
6. 画像サイズと品質を確認

### Solution 2の分離モード確認

天体間距離が10分角を超える星を選択すると、自動的に分離モードに切り替わります。
モーダルのタイトルに「分離表示モード」と表示されることを確認してください。

## 関連ドキュメント

- [実現可能性調査報告](../MIMIZUKU_DUAL_FIELD_改善調査報告.md)
- [Solution 1 詳細](solution1/README.md)
- [Solution 2 詳細](solution2/README.md)
