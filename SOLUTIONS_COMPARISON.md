# MIMIZUKU Dual Field 改善案の比較

## 問題の可視化

### 現在の問題（改善前）

```
天体間距離が大きい場合:
┌─────────────────────────────────────┐
│                                     │
│         広い視野角（FoV）           │
│                                     │
│   ┌─┐              ┌─┐           │
│   │T│              │G│  ←小さい  │
│   └─┘              └─┘           │
│                                     │
└─────────────────────────────────────┘
結果: 1'×2'の切り出しが小さくなる
```

## Solution 1: 固定サイズ表示 + 高解像度化

### アプローチ
元の方式を維持しつつ、出力を固定サイズにスケールアップ

```
処理フロー:
1. html2canvas scale: 5 でキャプチャ
   ┌─────────────────────────────────────┐
   │     より高解像度でキャプチャ         │
   │   ┌─┐              ┌─┐           │
   │   │T│              │G│            │
   │   └─┘              └─┘           │
   └─────────────────────────────────────┘

2. 切り出し
   ┌─┐              ┌─┐
   │T│              │G│  ←元は小さい
   └─┘              └─┘

3. 固定サイズ（300×600px）にスケールアップ
   ┌───┐            ┌───┐
   │   │            │   │  ←固定サイズ
   │ T │            │ G │
   │   │            │   │
   └───┘            └───┘

4. 結合・回転
   ┌───┬───┐
   │   │   │
   │ T │ G │  ←常に同じサイズで表示
   │   │   │
   └───┴───┘
```

### メリット
✅ 実装が簡単
✅ 常に同じサイズで表示される
✅ 既存UIを維持

### デメリット
⚠️ 元画像が低解像度の場合、ぼやける
⚠️ 根本的な解像度不足は解決できない

## Solution 2: 分離表示モード

### アプローチ
天体間距離が大きい場合、各天体を独立したビューで表示

```
距離判定:
if (天体間距離 > 10分角) {
    分離モード
} else {
    通常モード（Solution 1と同様）
}
```

### 通常モード（距離 ≤ 10'）
```
┌─────────────────────────────────────┐
│        単一のAladinビュー            │
│   ┌─┐         ┌─┐                │
│   │T│         │G│                 │
│   └─┘         └─┘                │
└─────────────────────────────────────┘
```

### 分離モード（距離 > 10'）
```
2つの独立したAladinビュー:

┌─────────────────┬─────────────────┐
│  Target (黄)    │  Guide Star (青) │
│                 │                 │
│  ┌───────┐      │  ┌───────┐     │
│  │       │      │  │       │     │
│  │   T   │      │  │   G   │     │
│  │       │      │  │       │     │
│  └───────┘      │  └───────┘     │
│                 │                 │
│ FoV: 3分角固定  │ FoV: 3分角固定  │
└─────────────────┴─────────────────┘

各ビューは狭いFoVで高解像度タイルを取得
```

### PNG変換
```
分離モードでPNG変換:
1. 各ビューを個別にキャプチャ（scale: 4）
   ┌───────┐      ┌───────┐
   │       │      │       │
   │   T   │      │   G   │  ←各々が高解像度
   │       │      │       │
   └───────┘      └───────┘

2. 1'×2'フィールドを切り出し
   ┌───┐          ┌───┐
   │   │          │   │
   │ T │          │ G │  ←高品質
   │   │          │   │
   └───┘          └───┘

3. 結合・回転
   ┌───┬───┐
   │   │   │
   │ T │ G │  ←常に高解像度
   │   │   │
   └───┴───┘
```

### メリット
✅ 常に高解像度を保証
✅ 距離に関係なく同じ品質
✅ 実際の観測イメージに近い

### デメリット
⚠️ 実装が複雑
⚠️ メモリ使用量が増加
⚠️ 相対位置関係がわかりにくい

## 比較表

| 項目 | Solution 1 | Solution 2 |
|------|-----------|-----------|
| **実装難易度** | 低 | 中 |
| **実装時間** | 2-3時間 | 1-2日 |
| **画質（近距離）** | 良好 | 良好 |
| **画質（遠距離）** | 可（制限あり） | 優秀 |
| **出力サイズ** | 固定（300×600px） | 切り出しサイズに依存 |
| **メモリ使用量** | 通常 | 増加（分離モード時） |
| **UI変更** | なし | あり（分離モード時） |
| **相対位置表示** | 維持 | 分離モード時は不明瞭 |

## 推奨される使い分け

### Solution 1を選ぶ場合
- 即座に改善が必要
- 実装リソースが限られている
- 既存UIを維持したい
- 大半の観測で天体間距離が小さい

### Solution 2を選ぶ場合
- 根本的な高画質化が必要
- 天体間距離が大きい観測が多い
- 実装に時間をかけられる
- 最高品質の画像が必要

## 段階的実装の推奨

調査報告書で推奨している通り、以下の順序での実装が最適です：

```
フェーズ1: Solution 1
    ↓
  リリース・フィードバック収集
    ↓
フェーズ2: Solution 2
    ↓
  リリース・最終評価
```

この段階的アプローチにより：
- 早期に改善を提供できる
- ユーザーフィードバックを活用できる
- リスクを分散できる
